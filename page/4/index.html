<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"blueinyou.com","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Paul C&#39;s Blog">
<meta property="og:url" content="https://blueinyou.com/page/4/index.html">
<meta property="og:site_name" content="Paul C&#39;s Blog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Paul C">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://blueinyou.com/page/4/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Paul C's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Paul C's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">To be funny,to grow up!</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blueinyou.com/categories/ML/Few-Shot19/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://blueinyou.com/photos/avatar.jpg">
      <meta itemprop="name" content="Paul C">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Paul C's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/categories/ML/Few-Shot19/" class="post-title-link" itemprop="url">利用三阶段特征选择和数据不平衡纠正增强勒索软件分类</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2023-07-31 16:13:22 / Modified: 17:16:34" itemprop="dateCreated datePublished" datetime="2023-07-31T16:13:22+08:00">2023-07-31</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ML/" itemprop="url" rel="index"><span itemprop="name">机器学习</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>勒索软件维度太多、数据不平衡，不容易建立模型。</p>
<ul>
<li>考虑样本不同特征组的重要程度，三阶段特征选择，解决样本维度问题；</li>
<li>代价敏感学习(Cost Sensitive Learning)和SMOTE重采样解决数据不平衡问题。</li>
</ul>
<h3 id><a href="#" class="headerlink" title=" "></a> </h3>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blueinyou.com/categories/Notes/IDAPro01/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://blueinyou.com/photos/avatar.jpg">
      <meta itemprop="name" content="Paul C">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Paul C's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/categories/Notes/IDAPro01/" class="post-title-link" itemprop="url">SP-Analysis failed[Xctf g0Re]</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2023-07-29 14:58:58" itemprop="dateCreated datePublished" datetime="2023-07-29T14:58:58+08:00">2023-07-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-07-30 21:24:58" itemprop="dateModified" datetime="2023-07-30T21:24:58+08:00">2023-07-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Notes/" itemprop="url" rel="index"><span itemprop="name">笔记</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>xctf的一道Go语言逆向题，涉及AES加密和base64换表加密。</p>
<p>用IDA打开g0Re报告<code>SP-Analysis failed</code>错误。</p>
<p><img src="/categories/Notes/IDAPro01/1690613919182.png" alt="1690613919182"></p>
<h2 id="静态检测"><a href="#静态检测" class="headerlink" title="静态检测"></a>静态检测</h2><p>将文件拷贝到kali后，静态检测一番。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ file g0Re               </span><br><span class="line">g0Re: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, no section header</span><br><span class="line"></span><br><span class="line">readelf -hlS --w g0Re</span><br></pre></td></tr></table></figure>
<p>报告如下错误：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">readelf: Warning: Section 49 has an out of range sh_link value of 2302008908</span><br><span class="line">Section Headers:</span><br><span class="line">  [Nr] Name              Type            Address          Off    Size   ES Flg Lk Inf Al</span><br><span class="line">  [ 0] &lt;no-strings&gt;      00010102: &lt;unknown&gt; 00000001003e0002 481cb0 000040 400003      0   0 15762873573703680</span><br><span class="line">readelf: Warning: [ 1]: Link field (533963) should index a symtab section.</span><br><span class="line">readelf: Warning: [ 3]: Unexpected value (1482181455) in info field.</span><br></pre></td></tr></table></figure>
<p>strings找到一些特征字符串<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/idawork]</span><br><span class="line">└─$ strings -a  -tx g0Re|grep -E &#x27;\s&#123;4,30&#125;&#x27;</span><br><span class="line">     ec OKXX$</span><br><span class="line">    13e FN&#123;o</span><br><span class="line">    1e6 r mL</span><br><span class="line">    284 dRe6eYPgXygMd</span><br><span class="line">    295 fSCPpMP/C9DU36D2kliiYS5D9wKG/E_p</span><br><span class="line">    2b9 XkJb3WwcGMbUPd63r/bG8gVDS6EsZ5vv</span><br><span class="line">  81e18 $Info: This file is packed with the                                           </span><br><span class="line">  81e67 $Id:  </span><br></pre></td></tr></table></figure></p>
<p>猜测是UPX加壳，但是UPX标志被抹去了。</p>
<h2 id="UPX-标志被抹除"><a href="#UPX-标志被抹除" class="headerlink" title="UPX! 标志被抹除"></a>UPX! 标志被抹除</h2><p>unpack时会依次在三个地方检查UPX_MAGIC_LE32（即”UPX!”）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1、在倒数第36字节偏移处检查，如果特征值不符就会转入throwNotPacked()异常抛出函数，打印not packed by UPX；</span><br><span class="line">2、&quot;.ELF&quot;魔数前36字节处，如果这里的特征值不符就会转入throwCantUnpack()异常抛出函数，打印l_info corrupted；</span><br><span class="line">3、 在倒数第46字节偏移处检查，如果特征值不符就会转入throwCompressedDataViolation()异常抛出函数，打印Exception: compressed data violation；</span><br></pre></td></tr></table></figure>
<p><img src="/categories/Notes/IDAPro01/1690711701628.png" alt="1690711701628"></p>
<p>结合上面的规则2，可以很清晰地判断出出题人用<code>0KXX</code>代替了<code>UPX!</code>。</p>
<p><img src="/categories/Notes/IDAPro01/1690712364661.png" alt="1690712364661"></p>
<p>在对应的三个位置处换上UPX!魔数。</p>
<p><img src="/categories/Notes/IDAPro01/1690713002432.png" alt="1690713002432"></p>
<p><img src="/categories/Notes/IDAPro01/1690712555711.png" alt="1690712555711"></p>
<p>upx脱壳。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/idawork]</span><br><span class="line">└─$ upx -d g0Re_upx </span><br><span class="line">                       Ultimate Packer for eXecutables</span><br><span class="line">                          Copyright (C) 1996 - 2020</span><br><span class="line">UPX 3.96        Markus Oberhumer, Laszlo Molnar &amp; John Reiser   Jan 23rd 2020</span><br><span class="line"></span><br><span class="line">        File size         Ratio      Format      Name</span><br><span class="line">   --------------------   ------   -----------   -----------</span><br><span class="line">   1331200 &lt;-    534092   40.12%   linux/amd64   g0Re_upx</span><br><span class="line"></span><br><span class="line">Unpacked 1 file.</span><br></pre></td></tr></table></figure>
<h2 id="输入flag后的处理流程"><a href="#输入flag后的处理流程" class="headerlink" title="输入flag后的处理流程"></a>输入flag后的处理流程</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_int64 __usercall sub_48CD80@&lt;rax&gt;(__int64 i%16@&lt;rdi&gt;, __int64 key[i%16]@&lt;rsi&gt;, __int64 a3@&lt;r14&gt;, __int128 a4@&lt;xmm15&gt;)</span><br></pre></td></tr></table></figure>
<p>1.aes   2.base64    3.简单运算</p>
<p><img src="/categories/Notes/IDAPro01/1690723199822.png" alt="1690723199822"></p>
<p><img src="/categories/Notes/IDAPro01/1690723104727.png" alt="1690723104727"></p>
<h2 id="aes加密-密钥获取"><a href="#aes加密-密钥获取" class="headerlink" title="aes加密 密钥获取"></a>aes加密 密钥获取</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">动态调试获取密钥：wvgitbygwbk2b46d</span><br></pre></td></tr></table></figure>
<p>启动ida服务端。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#端口，密码，详细模式</span></span><br><span class="line"><span class="comment">#若希望同时维护几个调试实例，就要在不同端口启动调试服务器。</span></span><br><span class="line">./linux_server64 -p23946 -p23946 -v</span><br><span class="line">IDA Linux 64-bit remote debug server(ST) v1.22. Hex-Rays (c) 2004-2017</span><br><span class="line">Listening on 0.0.0.0:23946...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="/categories/Notes/IDAPro01/1690716983450.png" alt="1690716983450"></p>
<p>Hex窗口与RSI同步。</p>
<p><img src="/categories/Notes/IDAPro01/1690718805904.png" alt="1690718805904"></p>
<h2 id="base64换表加密"><a href="#base64换表加密" class="headerlink" title="base64换表加密"></a>base64换表加密</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">strings -tx g0Re_upx|grep -E &#x27;[A-Z]&#123;10,64&#125;&#x27; </span><br><span class="line">12c040 456789&#125;#IJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123ABCDEFGH</span><br></pre></td></tr></table></figure>
<h2 id="解密脚本"><a href="#解密脚本" class="headerlink" title="解密脚本"></a>解密脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*-encoding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">string1 = <span class="string">&quot;456789&#125;#IJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123ABCDEFGH&quot;</span></span><br><span class="line">string2 = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line"><span class="comment">#ascii字符范围</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">filter_printable_chars</span>(<span class="params">flag</span>):</span><br><span class="line">    filtered_flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> byte <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="keyword">if</span> byte <span class="keyword">in</span> string1:</span><br><span class="line">            filtered_flag+=byte</span><br><span class="line">        <span class="comment">#else:</span></span><br><span class="line">            <span class="comment">#print(&quot;ERROR&quot;)</span></span><br><span class="line">            <span class="comment">#break</span></span><br><span class="line">    <span class="keyword">return</span> filtered_flag</span><br><span class="line"></span><br><span class="line">enc=[    <span class="number">0xE6</span>, <span class="number">0xCE</span>, <span class="number">0x89</span>, <span class="number">0xC8</span>, <span class="number">0xCF</span>, <span class="number">0xC5</span>, <span class="number">0xF5</span>, <span class="number">0xC9</span>, <span class="number">0xD2</span>, <span class="number">0xD9</span>,   <span class="number">0xC0</span>, <span class="number">0x91</span>, <span class="number">0xCE</span>, <span class="number">0x7F</span>, <span class="number">0xAC</span>, <span class="number">0xCC</span>, <span class="number">0xE9</span>, <span class="number">0xCF</span>, <span class="number">0xB7</span>, <span class="number">0xC0</span>,   <span class="number">0x96</span>, <span class="number">0xD4</span>, <span class="number">0xEA</span>, <span class="number">0x92</span>, <span class="number">0xE2</span>, <span class="number">0xD7</span>, <span class="number">0xDF</span>, <span class="number">0x84</span>, <span class="number">0xCB</span>, <span class="number">0xA5</span>,   <span class="number">0xAE</span>, <span class="number">0x93</span>, <span class="number">0xA6</span>, <span class="number">0xCA</span>, <span class="number">0xBE</span>, <span class="number">0x97</span>, <span class="number">0xDF</span>, <span class="number">0xCE</span>, <span class="number">0xF0</span>, <span class="number">0xC9</span>,   <span class="number">0xB7</span>, <span class="number">0xE1</span>, <span class="number">0xAE</span>, <span class="number">0x6B</span>, <span class="number">0xC4</span>, <span class="number">0xB1</span>, <span class="number">0x65</span>, <span class="number">0xDB</span>, <span class="number">0xCE</span>, <span class="number">0xED</span>,   <span class="number">0x92</span>, <span class="number">0x93</span>, <span class="number">0xD6</span>, <span class="number">0x8C</span>, <span class="number">0xED</span>, <span class="number">0xC3</span>, <span class="number">0xA3</span>, <span class="number">0xDA</span>, <span class="number">0x94</span>, <span class="number">0xA5</span>,   <span class="number">0xAA</span>, <span class="number">0xB2</span>, <span class="number">0xB5</span>, <span class="number">0xA7</span>, <span class="number">0x55</span>]</span><br><span class="line">key=<span class="string">b&quot;wvgitbygwbk2b46d&quot;</span></span><br><span class="line">base = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):    </span><br><span class="line">    base+=<span class="built_in">chr</span>(((enc[i]-key[i%<span class="number">16</span>])^<span class="number">0x1a</span>) &amp;<span class="number">0xff</span>)</span><br><span class="line"><span class="built_in">print</span>(base)<span class="comment">#uB8EAyfxAmOEvQlrhCJM8hk1qonHskb55NM4qvmxZeY#xg5mMm10x0nF6b3iRdeYÄ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#过滤base64编码表里的字符</span></span><br><span class="line">str1=filter_printable_chars(base)</span><br><span class="line">result=base64.b64decode(str1.translate(<span class="built_in">str</span>.maketrans(string1,string2)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#AES解密</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES<span class="comment"># </span></span><br><span class="line">aes = AES.new(key,mode=AES.MODE_ECB)</span><br><span class="line"><span class="built_in">print</span>(aes.decrypt(result)) <span class="comment">#b&#x27;flag&#123;g0_1s_th3_b3st_1anguage_1n_the_wOrld!_xxx&#125;\x01&#x27;</span></span><br></pre></td></tr></table></figure>
<h2 id="反汇编算法"><a href="#反汇编算法" class="headerlink" title="反汇编算法"></a>反汇编算法</h2><ul>
<li>1.线性扫描反汇编 关键是确定代码起始位置，之后线性扫描整个代码段，并逐条反汇编每条指令。不会识别分支来解释控制流。<ul>
<li>优点：覆盖程序的所有代码段；</li>
<li>缺点：假设代码段中全是代码，没法处理代码段中混入的数据。</li>
</ul>
</li>
<li>2.递归下降反汇编。根据指令间的引用关系决定是否反汇编，在一个代码块内部，还是使用线性扫描算法。<ul>
<li>优点：大部分情况下可以区分代码和数据。</li>
<li>缺点：无法处理间接代码路径。</li>
</ul>
</li>
</ul>
<p>IDA pro是递归下降反汇编器。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//add、xor、mov、栈操作push</span></span><br><span class="line"><span class="keyword">case</span> 顺序流指令:</span><br><span class="line">	线性扫描反汇编</span><br><span class="line"><span class="comment">//jnz、ja</span></span><br><span class="line"><span class="keyword">case</span> 条件分支指令:</span><br><span class="line">	反汇编两个路径，直接反汇编下一条指令对应的分支，将跳转目标指令的地址加入延迟反汇编地址列表。</span><br><span class="line"><span class="comment">//jmp</span></span><br><span class="line"><span class="keyword">case</span> 无条件分支指令:</span><br><span class="line">	确定跳转目标，反汇编目的地址；对于无条件分支后的字节不作处理。</span><br><span class="line">，</span><br><span class="line"><span class="comment">//call</span></span><br><span class="line"><span class="keyword">case</span> 函数调用指令:</span><br><span class="line">	运行方式类似于无条件跳转，但是其后的返回地址会被直接反汇编，将跳转目标指令的地址加入延迟反汇编地址列表。</span><br><span class="line"><span class="comment">//ret,</span></span><br><span class="line"><span class="keyword">case</span> 返回指令:</span><br><span class="line">	获取接下来将要执行的指令信息；有时需要从栈顶获取，而静态反汇编器不具备访问栈的能力。此时反汇编器会开始处理延迟反汇编地址列表。</span><br></pre></td></tr></table></figure>
<h2 id="反汇编出问题的情形"><a href="#反汇编出问题的情形" class="headerlink" title="反汇编出问题的情形"></a>反汇编出问题的情形</h2><p>1.对于无条件分支指令，例如jmp eax这样的运行时才能确定跳转地址的指令，需要人工赋值。</p>
<p>2.call指令，在函数内部篡改了函数返回地址。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">foo proc near</span><br><span class="line">	inc  dword ptr[esp];</span><br><span class="line">	retn</span><br><span class="line">endp</span><br><span class="line">//错误的反汇编</span><br><span class="line">E8 F7 FF FF FF call foo</span><br><span class="line">05 89 45 F8 90 add eax,90F84589h</span><br><span class="line"></span><br><span class="line">//正确的反汇编</span><br><span class="line">E8 F7 FF FF FF call foo</span><br><span class="line">05 				db  5</span><br><span class="line">89 45 F8 		mov [ebp-8],eax</span><br><span class="line">90 				nop</span><br></pre></td></tr></table></figure>
<p>3.ret没有提供返回地址。</p>
<p><img src="/categories/Notes/IDAPro01/1690714484074.png" alt="1690714484074"></p>
<p> IDA遇到的函数返回语句，检测到其栈指针值不为0。</p>
<h2 id="反汇编的困难"><a href="#反汇编的困难" class="headerlink" title="反汇编的困难"></a>反汇编的困难</h2><p>1.编译，和自然语言的翻译一样是一个多对多操作。除了C编译器，还有Go、Python、Delphi编译器、WinAPI库，反编译器非常依赖语言和库。</p>
<p>2.编译过程中会丢失命名和类型信息。反汇编后最多知道变量的位数，类型信息需要通过变量的用途确定。</p>
<h2 id="一些静态工具用法"><a href="#一些静态工具用法" class="headerlink" title="一些静态工具用法"></a>一些静态工具用法</h2><ul>
<li><p>Linux:ldd；  nm展示符号，C++filter、展示重定义。</p>
</li>
<li><p>OSX:otool；  处理MACH-O。</p>
</li>
<li><p>Windows:VS里的dumpbin /dependents  ；objdump</p>
</li>
</ul>
<h3 id="ldd显示依赖库"><a href="#ldd显示依赖库" class="headerlink" title="ldd显示依赖库"></a>ldd显示依赖库</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/idawork]</span><br><span class="line">└─$ ldd linux_server64 </span><br><span class="line">        linux-vdso.so.1 (0x00007fff323bf000)</span><br><span class="line">        libdl.so.2 =&gt; /lib/x86_64-linux-gnu/libdl.so.2 (0x00007fbfef767000)</span><br><span class="line">        libthread_db.so.1 =&gt; /lib/x86_64-linux-gnu/libthread_db.so.1 (0x00007fbfef75c000)</span><br><span class="line">        librt.so.1 =&gt; /lib/x86_64-linux-gnu/librt.so.1 (0x00007fbfef751000)</span><br><span class="line">        libpthread.so.0 =&gt; /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007fbfef730000)</span><br><span class="line">        libstdc++.so.6 =&gt; /lib/x86_64-linux-gnu/libstdc++.so.6 (0x00007fbfef515000)</span><br><span class="line">        libm.so.6 =&gt; /lib/x86_64-linux-gnu/libm.so.6 (0x00007fbfef3d2000)</span><br><span class="line">        libc.so.6 =&gt; /lib/x86_64-linux-gnu/libc.so.6 (0x00007fbfef1f6000)</span><br><span class="line">        /lib64/ld-linux-x86-64.so.2 (0x00007fbfef782000)</span><br><span class="line">        libgcc_s.so.1 =&gt; /lib/x86_64-linux-gnu/libgcc_s.so.1 (0x00007fbfef1d6000)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="dumpbin-dependents"><a href="#dumpbin-dependents" class="headerlink" title="dumpbin /dependents"></a>dumpbin /dependents</h3><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Dump of file baby.exe</span><br><span class="line"></span><br><span class="line">File <span class="built_in">Type</span>: EXECUTABLE IMAGE</span><br><span class="line"></span><br><span class="line">  Image has the following dependencies:</span><br><span class="line"></span><br><span class="line">    KERNEL32.dll</span><br><span class="line">    msvcrt.dll</span><br><span class="line">    msvcrt.dll</span><br><span class="line"></span><br><span class="line">  Summary</span><br><span class="line"></span><br><span class="line">        <span class="number">1000</span> .CRT  C runtime Lib</span><br><span class="line">        <span class="number">1000</span> .bss</span><br><span class="line">        <span class="number">1000</span> .data</span><br><span class="line">        <span class="number">1000</span> .debug_abbrev</span><br><span class="line">        <span class="number">1000</span> .debug_aranges</span><br><span class="line">        <span class="number">1000</span> .debug_frame</span><br><span class="line">        <span class="number">2000</span> .debug_info</span><br><span class="line">        <span class="number">1000</span> .debug_line</span><br><span class="line">        <span class="number">1000</span> .eh_frame</span><br><span class="line">        <span class="number">1000</span> .idata</span><br><span class="line">        <span class="number">1000</span> .rdata</span><br><span class="line">        <span class="number">3000</span> .text</span><br><span class="line">        <span class="number">1000</span> .tls</span><br></pre></td></tr></table></figure>
<h3 id="strings"><a href="#strings" class="headerlink" title="strings"></a>strings</h3><p>-t 显示字符的文件偏移</p>
<p>-a 使得strings扫描整个文件，而非只有文件中可加载的、经初始化的部分</p>
<p>-e 搜素其他字符编码，如Unicode</p>
<p>几乎不会用到的工具：x86流式反汇编器，ndisasm和diStorm。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blueinyou.com/categories/Notes/Win32_01/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://blueinyou.com/photos/avatar.jpg">
      <meta itemprop="name" content="Paul C">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Paul C's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/categories/Notes/Win32_01/" class="post-title-link" itemprop="url">Windows汇编语言基础</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2023-07-18 14:58:58" itemprop="dateCreated datePublished" datetime="2023-07-18T14:58:58+08:00">2023-07-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-08-02 16:33:58" itemprop="dateModified" datetime="2023-08-02T16:33:58+08:00">2023-08-02</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Notes/" itemprop="url" rel="index"><span itemprop="name">笔记</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="x86汇编语法"><a href="#x86汇编语法" class="headerlink" title="x86汇编语法"></a>x86汇编语法</h2><ul>
<li>AT&amp;T：GNU工具（Gas：GNU汇编器、gcc、gdb)         <ul>
<li>前缀：%reg,$立即数</li>
<li>操作数排序：mov 源操作数,目的操作数  add $0x4,%eax</li>
</ul>
</li>
<li>Intel ：MASM(微软汇编器)、Turbo汇编器、NASM<ul>
<li>add eax,0x4</li>
</ul>
</li>
</ul>
<p>.model flat，平坦模式，代码段和数据段共用一个4G段。</p>
<h2 id="局部变量、"><a href="#局部变量、" class="headerlink" title="局部变量、"></a>局部变量、</h2><p><strong>局部变量是堆栈变量</strong>。作用域是单个子程序，从子程序返回到主程序时被释放。一种规范写法是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LOCAL @buffer[10]:BYTE ;LOCAL 变量名1[重复数量]:类型,变量名2[重复数量]:类型</span><br></pre></td></tr></table></figure>
<p><code>LOCAL</code>用于为堆栈变量预留空间。</p>
<p>局部变量：只能在过程中用，主程序里不能用；</p>
<p>堆栈变量：没有初始值，只在调用时分配。C语言中的函数值传递的本质。</p>
<h2 id="一些常用类型整理"><a href="#一些常用类型整理" class="headerlink" title="一些常用类型整理"></a>一些常用类型整理</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">byte db,word dw,DWORD dd,fword df,QWORD dq,tbyte dt  1,2,4,6,8,10</span><br><span class="line">WNDCLASS</span><br></pre></td></tr></table></figure>
<ul>
<li>TYPE返回变量大小</li>
<li>LENGTHOF  返回变量元素个数</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">;,用于表示一个变量是否结束</span><br><span class="line">var6 dw 10,20,30,40,50</span><br><span class="line">	 dw 60,70,80,90,99</span><br><span class="line">var7 dw 10,20,30,40,50,</span><br><span class="line">	    60,70,80,90,99	 </span><br><span class="line">LENGTHOF var6 ;5</span><br><span class="line">LENGTHOF var7 ;10</span><br></pre></td></tr></table></figure>
<ul>
<li>SIZE，SIZEOF返回所占字节数=LENGTHOF*TYPR</li>
</ul>
<h2 id="1-和EQU伪指令"><a href="#1-和EQU伪指令" class="headerlink" title="1.=和EQU伪指令"></a>1.=和EQU伪指令</h2><p>由等号或者EQU定义的符号常量<strong>不占用存储空间。</strong></p>
<p>EQU类似于等号伪指令，但是EQU伪指令不许重复定义，而等号伪指令可以（同一个常量名可重复定义多次）。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">presskey EQU &lt;&quot;Output is:&quot;&gt;</span><br><span class="line">.data</span><br><span class="line">propt db presskey</span><br></pre></td></tr></table></figure>
<h2 id="2-当前地址运算符"><a href="#2-当前地址运算符" class="headerlink" title="2.$ 当前地址运算符"></a>2.$ 当前地址运算符</h2><h2 id="3-LEA伪指令"><a href="#3-LEA伪指令" class="headerlink" title="3.LEA伪指令"></a>3.LEA伪指令</h2><p>OFFSET和ADDR编译时起作用，LEA是指令，在运行时起作用。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MOV ESI,ADDR BVAL  ;相当于</span><br><span class="line">LEA ESi,BVAL</span><br></pre></td></tr></table></figure>
<p>计算堆栈（程序执行是分配）变量的偏移地址时，只能用lea。</p>
<h2 id="4-PTR-操作符"><a href="#4-PTR-操作符" class="headerlink" title="4.PTR 操作符"></a>4.PTR 操作符</h2><p>按照指定类型在内存中读写值。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LIST DB 12H,34H,56H,78H;</span><br><span class="line">MOV EAX,DWORD PTR LIST ;EAX  78563412H</span><br></pre></td></tr></table></figure>
<h2 id="5-ALIGN和EVEN伪指令"><a href="#5-ALIGN和EVEN伪指令" class="headerlink" title="5.ALIGN和EVEN伪指令"></a>5.ALIGN和EVEN伪指令</h2><blockquote>
<p>CPU处理偶数地址比处理奇数地址要快。 可以在一个内存访问周期内获取该数据 </p>
</blockquote>
<p>ALIGN 对齐 (1,2,4)  按照n个字节的边界值对齐</p>
<p>EVEN  使下一地址从偶数地址开始</p>
<h2 id="6-TYPEDEF和TYPEDEF-PTR操作符"><a href="#6-TYPEDEF和TYPEDEF-PTR操作符" class="headerlink" title="6.TYPEDEF和TYPEDEF PTR操作符"></a>6.TYPEDEF和TYPEDEF PTR操作符</h2><p>类型自命名和定义指针的类型，<strong>不占用存储空间</strong></p>
<h2 id="7-LABEL伪指令"><a href="#7-LABEL伪指令" class="headerlink" title="7.LABEL伪指令"></a>7.LABEL伪指令</h2><p>别名，<strong>不占用存储空间</strong></p>
<h2 id="8-基数控制伪指令RAIDX"><a href="#8-基数控制伪指令RAIDX" class="headerlink" title="8.基数控制伪指令RAIDX"></a>8.基数控制伪指令RAIDX</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.RADIX  16;默认该指令后面的数据都是16进制数，其他进制的数据需要额外说明</span><br><span class="line"></span><br><span class="line">MOV AX,0FF ;十六进制数,对应十进制255</span><br><span class="line">MOV BX ,12D ;十进制数12</span><br></pre></td></tr></table></figure>
<p>9.ORG伪指令</p>
<p>10.REPT伪指令</p>
<h2 id="11-ASSUME伪指令"><a href="#11-ASSUME伪指令" class="headerlink" title="11.ASSUME伪指令"></a>11.ASSUME伪指令</h2><p>将程序的段与逻辑段绑定。</p>
<h2 id="12-SHORT伪指令"><a href="#12-SHORT伪指令" class="headerlink" title="12.SHORT伪指令"></a>12.SHORT伪指令</h2><h2 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">.while(条件)</span><br><span class="line">.endw</span><br><span class="line"></span><br><span class="line">.repeat</span><br><span class="line"></span><br><span class="line">until(条件)</span><br><span class="line"></span><br><span class="line">.if </span><br><span class="line">.elseif</span><br><span class="line">.endif</span><br><span class="line">.break .if ;退出循环</span><br><span class="line">.continue ;结束本次循环，进入下一次循环</span><br></pre></td></tr></table></figure>
<h2 id="14-结构体和共用体"><a href="#14-结构体和共用体" class="headerlink" title="14.结构体和共用体"></a>14.结构体和共用体</h2><h2 id="15-宏定义"><a href="#15-宏定义" class="headerlink" title="15.宏定义"></a>15.宏定义</h2><h2 id="16-过程"><a href="#16-过程" class="headerlink" title="16.过程"></a>16.过程</h2><p>模块化代码</p>
<p>PROC [NEAR] 或者[FAR]，默认近调用，即在ODS实模式下的一个段里(&lt;64KB(。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">主程序中 CALL &#123;PROC_noarg_name&#125;</span><br><span class="line"></span><br><span class="line">PUSH 参数2</span><br><span class="line">PUSH 参数1</span><br><span class="line">INVOKE &#123;PROC_noarg_name&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;PROC_noarg_name&#125; PROC [NEAR]</span><br><span class="line">	LOCAL 变量名1[重复数量]:类型,变量名2[重复数量]:类型</span><br><span class="line">	RET   ;从栈中弹出返回地址，返回到主程序</span><br><span class="line">&#123;PROC_noarg_name&#125; ENDP	</span><br><span class="line"></span><br><span class="line">&#123;PROC_name&#125; PROC,参数1:类型,参数2:类型,...</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="17-ENTER和LEAVE"><a href="#17-ENTER和LEAVE" class="headerlink" title="17.ENTER和LEAVE"></a>17.ENTER和LEAVE</h2><h2 id="18-RET和RETN"><a href="#18-RET和RETN" class="headerlink" title="18.RET和RETN"></a>18.RET和RETN</h2><h2 id="19-IDA的反汇编"><a href="#19-IDA的反汇编" class="headerlink" title="19.IDA的反汇编"></a>19.IDA的反汇编</h2><h2 id="0day-安全"><a href="#0day-安全" class="headerlink" title="0day 安全"></a>0day 安全</h2><p> 文件偏移地址 = 虚拟内存地址（VA）−装载基址（Image Base）−节偏移<br>= RVA -节偏移 </p>
<p>对于 栈桢可能发生移位的情况 </p>
<h2 id="解决办法："><a href="#解决办法：" class="headerlink" title="解决办法："></a>解决办法：</h2><p> 一个函数返回时，esp正好指向原来存储返回地址的下一位，我们将shellcode从ret_addr的后一个位置开始填充，并将ret_addr填充为一个进程中的”jmp esp”的指令的地址，这样函数返回后就会跳到esp指向的栈顶的位置开始执行shellcode。 </p>
<p>缓冲区组成方式，现阶段已经讲了两种：</p>
<ol>
<li>将shellcode放到缓冲区，然后覆盖返回地址到缓冲区的起始地址。这种适用于缓冲区较大的场合。</li>
<li><p>将shellcode放到函数返回地址以后，然后覆盖返回地址为”jmp esp”之类的指令，使得函数返回时跳转到shellcode处执行指令。这种适用于缓冲区较小的场合。</p>
</li>
<li><p>找到程序运行的线程环境块TEB。</p>
</li>
<li>TEB的起始地址偏移0x30的地方指向进程环境块PEB。</li>
<li>PEB的地址偏移0x0C的地方存放指向PEB_LDR_DATA结构体的指针，该指针指向一个存放着被进程装载的动态链接库的信息的结构体。</li>
<li>PEB_LDR_DATA结构体偏移位置位0x1C的地方指向模块初始化链表的头指针InInitializationOrderModuleList。</li>
<li>4中的链表存放PE被载入时初始化的模块信息，第一个链表节点时ntdll.dll，第二个位kernel32.dll。</li>
<li>kernel32.dll的节点偏移0x08是kernel32.dll在内存中载入的基址。</li>
<li>kernel32.dll的基址加0xe3C是PE头的地址。</li>
<li>PE头偏移0x78存放着指向函数导出表的指针。</li>
<li>安照下述方法寻址：<ul>
<li>导出表偏移0x1C的指针指向存储导出函数偏移地址（RVA）的列表。</li>
<li>导出表偏移0x20指针指向存储导出函数名的列表。</li>
<li>根据函数名找到我们要的函数是导出表中的第几个，然后再地址列表中找到对应RVA。</li>
<li>RVA加上动态链接库的基址即是VA，这个也是我们在shellcode中需要的地址。</li>
</ul>
</li>
</ol>
<p>这里shellcode的构造为了尽可能的短，所以需要给每个API名字用一个hash去代替。<br>MessageBoxA：0x1e380a6a<br>ExitProcess：0x4fd18963<br>LoadLibraryA：0x0c917432</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">push 0x1e380a6a</span><br><span class="line">push 0x4fd18963 </span><br><span class="line">push 0x0c917432</span><br><span class="line">mov esi,esp</span><br><span class="line">lea edi,[esi-0xC]</span><br></pre></td></tr></table></figure>
<h2 id="如何实现一款-shellcodeLoader"><a href="#如何实现一款-shellcodeLoader" class="headerlink" title="如何实现一款 shellcodeLoader"></a>如何实现一款 shellcodeLoader</h2><p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1755926">https://cloud.tencent.com/developer/article/1755926</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blueinyou.com/categories/CTF/Windows01/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://blueinyou.com/photos/avatar.jpg">
      <meta itemprop="name" content="Paul C">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Paul C's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/categories/CTF/Windows01/" class="post-title-link" itemprop="url">MITRE ATT&CK™ 矩阵</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2023-07-16 14:19:49" itemprop="dateCreated datePublished" datetime="2023-07-16T14:19:49+08:00">2023-07-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-08-29 11:16:34" itemprop="dateModified" datetime="2023-08-29T11:16:34+08:00">2023-08-29</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>本文记录那些恶意软件使用的关键API。</p>
<p>NtProtectVirtualMemory ,创建PAGE_GUARD属性的内存页，通常用于反逆向和反调试 ； 将可读可写的内存属性改为可读可执行 。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blueinyou.com/categories/CTF/rev01/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://blueinyou.com/photos/avatar.jpg">
      <meta itemprop="name" content="Paul C">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Paul C's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/categories/CTF/rev01/" class="post-title-link" itemprop="url">zer0pt chall题解</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2023-07-16 14:19:49" itemprop="dateCreated datePublished" datetime="2023-07-16T14:19:49+08:00">2023-07-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-08-29 09:52:08" itemprop="dateModified" datetime="2023-08-29T09:52:08+08:00">2023-08-29</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>这道题是一道已知RC4的密文和密钥，反求明文的伪装成逆向的密码题。</p>
<p><img src="/categories/CTF/rev01/1689514292270.png" alt="1689514292270"></p>
<p>​                                                                    图1</p>
<h2 id="思考"><a href="#思考" class="headerlink" title="思考"></a>思考</h2><p>反汇编时，要深入每个关键函数看一看，不能想当然。</p>
<p>IDA给出的伪代码代码大部分时候还是十分正确的，直接看伪代码比反汇编代码正确率要来得高。</p>
<h2 id="干扰项："><a href="#干扰项：" class="headerlink" title="干扰项："></a>干扰项：</h2><p><img src="/categories/CTF/rev01/1689514736957.png" alt="1689514736957"></p>
<p>在IDA的反汇编界面看代码，会误以为密钥为key</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">key_rodata = b&quot;\xBE\xBA\xFE\xCA\xEF\xBE\xAD\xDE&quot;</span><br></pre></td></tr></table></figure>
<p>也会误认为密文为enc</p>
<p><img src="/categories/CTF/rev01/1689514809165.png" alt="1689514809165"></p>
<p>不管任何一个弄错，都会使得结果错误。</p>
<p>干扰原因：按照C调用约定，在call之前的部分应该是函数的参数部分，但是<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">__int64 __usercall RC4_setkey@&lt;rax&gt;(__int64 RC4_key@&lt;r12&gt;, __int64 RC4_keytable@&lt;r13&gt;)</span><br><span class="line">char __usercall memcmp@&lt;al&gt;(unsigned int a1@&lt;edx&gt;, __int64 a2@&lt;r14&gt;)</span><br></pre></td></tr></table></figure></p>
<p>这里是作者自定义的call行为，call之前的内容并不全是函数的参数。</p>
<p>对于RC4_setkey，其真正的RC4_key是r12,。</p>
<p><img src="/categories/CTF/rev01/1689515709788.png" alt="1689515709788"></p>
<p>而r12早就被赋予了值，其值为val，在got表中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">main         push    rbp</span><br><span class="line">main+1      sub     rsp, 200h</span><br><span class="line">main+8      mov     ecx, 200h</span><br><span class="line">main+D      xor     eax, eax</span><br><span class="line">main+F      mov     rdi, rsp</span><br><span class="line">main+12     repne stosb</span><br><span class="line">main+14     mov     ebx, 6</span><br><span class="line">main+19     lea     rbp, flag       ; &quot;FLAG: &quot;</span><br><span class="line">main+20     lea     r12, val</span><br><span class="line">main+27     mov     r15, rsp</span><br><span class="line">main+2A     lea     r14, [r15+80h]</span><br><span class="line">main+31     lea     r13, [r15+100h]</span><br></pre></td></tr></table></figure>
<p>对于memcmp，也类似，在其函数内部，再次修改rsi，其真正比较的是dat和r14.</p>
<p><img src="/categories/CTF/rev01/1689516066778.png" alt="1689516066778"></p>
<p>正确的密钥和密文都在got表里</p>
<p>如图1所示，密钥应该为图1所示的val所对应的内容，密文应该为dat对应内容。</p>
<p><img src="/categories/CTF/rev01/1689515029709.png" alt="1689515029709"></p>
<h2 id="密文获取"><a href="#密文获取" class="headerlink" title="密文获取"></a>密文获取</h2><p><code>memcmp</code>里返回dat数组和传入的结果数组的比较情况，真正的密文应该是dat数组。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result |= *((_BYTE *)&amp;dat + v3) ^ *(_BYTE *)(a2 + v3);</span><br></pre></td></tr></table></figure>
<p>点击第一处字节后，按下(Alt+L)，再点击最后一处字节，就可以选定待导出的密文部分。</p>
<p><img src="/categories/CTF/rev01/1689513948497.png" alt="1689513948497"></p>
<p>Shift+E，导出Array数组，复制粘贴到python代码里。</p>
<p><img src="/categories/CTF/rev01/1689513831064.png" alt="1689513831064"></p>
<h2 id="解密代码："><a href="#解密代码：" class="headerlink" title="解密代码："></a>解密代码：</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 已知的密钥表和加密文本</span></span><br><span class="line">RC4_key=     <span class="string">b&quot;\x31\x09\x81\x19\x19\x14\x45\x11&quot;</span></span><br><span class="line">cmp_data =<span class="built_in">bytes</span>([</span><br><span class="line">  <span class="number">0x78</span>, <span class="number">0xCF</span>, <span class="number">0xC4</span>, <span class="number">0x85</span>, <span class="number">0xDC</span>, <span class="number">0x33</span>, <span class="number">0x07</span>, <span class="number">0x4C</span>, <span class="number">0x93</span>, <span class="number">0x35</span>, </span><br><span class="line">  <span class="number">0xFB</span>, <span class="number">0x7C</span>, <span class="number">0x10</span>, <span class="number">0x8E</span>, <span class="number">0xBE</span>, <span class="number">0x93</span>, <span class="number">0x28</span>, <span class="number">0xE6</span>, <span class="number">0x2E</span>, <span class="number">0x75</span>, </span><br><span class="line">  <span class="number">0xDA</span>, <span class="number">0x5E</span>, <span class="number">0x85</span>, <span class="number">0xC5</span>, <span class="number">0x91</span>, <span class="number">0x15</span>, <span class="number">0x75</span>, <span class="number">0x89</span>, <span class="number">0x48</span>, <span class="number">0x0E</span>, </span><br><span class="line">  <span class="number">0x29</span>, <span class="number">0xA4</span>, <span class="number">0xF9</span>, <span class="number">0xA6</span>, <span class="number">0x3A</span>, <span class="number">0x6E</span>, <span class="number">0x1F</span>, <span class="number">0x84</span>, <span class="number">0xF7</span>, <span class="number">0x42</span>, </span><br><span class="line">  <span class="number">0xB0</span>, <span class="number">0x93</span>, <span class="number">0x31</span>, <span class="number">0xF0</span>, <span class="number">0x68</span>, <span class="number">0xC0</span>, <span class="number">0x43</span>, <span class="number">0x38</span>, <span class="number">0x07</span>, <span class="number">0x32</span>, </span><br><span class="line">  <span class="number">0x09</span>, <span class="number">0x57</span>, <span class="number">0xDA</span>, <span class="number">0x32</span>, <span class="number">0x44</span>, <span class="number">0xCF</span>, <span class="number">0xCD</span>, <span class="number">0x8F</span>, <span class="number">0xE5</span>, <span class="number">0xBF</span>, </span><br><span class="line">  <span class="number">0xE3</span>, <span class="number">0xD6</span>, <span class="number">0xBB</span>, <span class="number">0x59</span>, <span class="number">0x9A</span>, <span class="number">0x6A</span>, <span class="number">0x84</span>, <span class="number">0x85</span>, <span class="number">0xD3</span>, <span class="number">0x22</span>, </span><br><span class="line">  <span class="number">0xA9</span>, <span class="number">0x8E</span>, <span class="number">0xB5</span>, <span class="number">0xEA</span>, <span class="number">0xBD</span>, <span class="number">0x57</span>, <span class="number">0xDE</span>, <span class="number">0xB1</span>, <span class="number">0x6C</span>, <span class="number">0x93</span>, </span><br><span class="line">  <span class="number">0xE4</span>, <span class="number">0x74</span>, <span class="number">0x70</span>, <span class="number">0xAC</span>, <span class="number">0x1A</span>, <span class="number">0x03</span>, <span class="number">0xD9</span>, <span class="number">0x16</span>, <span class="number">0x9F</span>, <span class="number">0xBC</span>, </span><br><span class="line">  <span class="number">0x97</span>, <span class="number">0xFB</span>, <span class="number">0x85</span>, <span class="number">0xD9</span>, <span class="number">0xA6</span>, <span class="number">0x9E</span>, <span class="number">0xD4</span>, <span class="number">0xD6</span>, <span class="number">0x02</span>, <span class="number">0x59</span>, </span><br><span class="line">  <span class="number">0xD5</span>, <span class="number">0x28</span>, <span class="number">0xB3</span>, <span class="number">0x93</span>, <span class="number">0x16</span>, <span class="number">0xB6</span>, <span class="number">0xC4</span>, <span class="number">0x78</span>, <span class="number">0xC4</span>, <span class="number">0xA2</span>, </span><br><span class="line">  <span class="number">0x12</span>, <span class="number">0xD2</span>, <span class="number">0xEF</span>, <span class="number">0xB1</span>, <span class="number">0x54</span>, <span class="number">0x18</span>, <span class="number">0xFD</span>, <span class="number">0x76</span>, <span class="number">0x51</span>, <span class="number">0xA3</span>, </span><br><span class="line">  <span class="number">0x5E</span>, <span class="number">0x57</span>, <span class="number">0xB8</span>, <span class="number">0x58</span>, <span class="number">0x4B</span>, <span class="number">0x1E</span>, <span class="number">0xE2</span>, <span class="number">0x41</span></span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">RC4_setkey</span>(<span class="params">key, keytable</span>):</span><br><span class="line">    keytable_length = <span class="number">256</span><span class="comment">#len(keytable)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 初始化密钥表</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(keytable_length):</span><br><span class="line">        keytable[i] = i</span><br><span class="line"></span><br><span class="line">    <span class="comment"># KSA (密钥调度算法)</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(keytable_length):</span><br><span class="line">        j = (j + keytable[i] + key[i % <span class="built_in">len</span>(key)]) % keytable_length</span><br><span class="line">        keytable[i], keytable[j] = keytable[j], keytable[i]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> keytable</span><br><span class="line"></span><br><span class="line"><span class="comment">#zer0pts要求的字符范围</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">filter_printable_chars</span>(<span class="params">flag</span>):</span><br><span class="line">    filtered_flag = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> byte <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="keyword">if</span> <span class="number">0x20</span> &lt;= byte &lt;= <span class="number">0x7E</span>:</span><br><span class="line">            filtered_flag.append(byte)</span><br><span class="line">        <span class="comment">#else:</span></span><br><span class="line">            <span class="comment">#print(&quot;ERROR&quot;)</span></span><br><span class="line">            <span class="comment">#break</span></span><br><span class="line">    <span class="keyword">return</span> filtered_flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_keytable</span>(<span class="params">keytable, enc_text</span>):</span><br><span class="line">    flag_length = <span class="built_in">len</span>(enc_text)</span><br><span class="line">    v4 = <span class="number">0</span></span><br><span class="line">    v5 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> v3 <span class="keyword">in</span> <span class="built_in">range</span>(flag_length):</span><br><span class="line">        v4 = (v4 + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        v5 = (keytable[v4] + v5) % <span class="number">256</span></span><br><span class="line">        keytable[v4], keytable[v5] = keytable[v5], keytable[v4]</span><br><span class="line">        <span class="comment">#flag[v3] = enc_text[v3] ^ keytable[(keytable[v5] + keytable[v4]) % 256]</span></span><br><span class="line">    <span class="keyword">return</span> v4,v5</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">RC4_decrypt</span>(<span class="params">keytable, enc_text,v4,v5</span>):</span><br><span class="line">    flag_length = <span class="built_in">len</span>(enc_text)</span><br><span class="line">    flag = <span class="built_in">bytearray</span>([<span class="number">0</span>] * flag_length)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> v3 <span class="keyword">in</span> <span class="built_in">range</span>(flag_length-<span class="number">1</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">        flag[v3] = enc_text[v3] ^ keytable[(keytable[v5] + keytable[v4]) % <span class="number">256</span>]</span><br><span class="line">        keytable[v4], keytable[v5] = keytable[v5], keytable[v4]</span><br><span class="line">        v5 = (v5-keytable[v4]) % <span class="number">256</span></span><br><span class="line">        v4 = (v4 - <span class="number">1</span>) % <span class="number">256</span> </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获得密钥表</span></span><br><span class="line">RC4_keytable = <span class="built_in">bytearray</span>([<span class="number">0</span>] * <span class="number">520</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置密钥表</span></span><br><span class="line">RC4_setkey(RC4_key, RC4_keytable)</span><br><span class="line">hex_string = <span class="string">&#x27; &#x27;</span>.join([<span class="string">f&#x27;\\x<span class="subst">&#123;byte:02X&#125;</span>&#x27;</span> <span class="keyword">for</span> byte <span class="keyword">in</span> RC4_keytable])</span><br><span class="line"><span class="comment"># 打印密钥表</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;密钥表:\n&quot;</span>, hex_string)</span><br><span class="line"></span><br><span class="line"><span class="comment">#获得解密需要的初始值</span></span><br><span class="line">v4,v5=gen_keytable(RC4_keytable,cmp_data)</span><br><span class="line">hex_string = <span class="string">&#x27; &#x27;</span>.join([<span class="string">f&#x27;\\x<span class="subst">&#123;byte:02X&#125;</span>&#x27;</span> <span class="keyword">for</span> byte <span class="keyword">in</span> RC4_keytable])</span><br><span class="line"><span class="comment"># 打印密钥表</span></span><br><span class="line"><span class="comment">#print(&quot;密钥表:\n&quot;, hex_string)</span></span><br><span class="line"><span class="built_in">print</span>(v4,v5)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密获取flag</span></span><br><span class="line">flag = RC4_decrypt(RC4_keytable, cmp_data,v4,v5)</span><br><span class="line">filtered_flag=filter_printable_chars(flag)</span><br><span class="line"><span class="comment"># 打印flag</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Flag:&quot;</span>, filtered_flag.decode())</span><br></pre></td></tr></table></figure>
<p>最终结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Flag: zer0pts&#123;d0n&#x27;7_4lw4y5_7ru57_d3c0mp1l3r&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blueinyou.com/categories/Notes/Pediy01/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://blueinyou.com/photos/avatar.jpg">
      <meta itemprop="name" content="Paul C">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Paul C's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/categories/Notes/Pediy01/" class="post-title-link" itemprop="url">微信多实例运行</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2023-07-10 14:19:49" itemprop="dateCreated datePublished" datetime="2023-07-10T14:19:49+08:00">2023-07-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-08-02 16:31:10" itemprop="dateModified" datetime="2023-08-02T16:31:10+08:00">2023-08-02</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Notes/" itemprop="url" rel="index"><span itemprop="name">笔记</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p> ADVAPI.dll  提供高级系统功能,Advanced，如 注册表、安全性、事件日志、服务管理等 ；</p>
<p>查看API对应的源代码路径：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Program Files (x86)\Windows Kits\10\Include\10.0.19041.0\um</span><br></pre></td></tr></table></figure>
<h2 id="只运行一个实例"><a href="#只运行一个实例" class="headerlink" title="只运行一个实例"></a>只运行一个实例</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CreateMutexA</span><br><span class="line">FindWindowA</span><br><span class="line">使用共享Section</span><br></pre></td></tr></table></figure>
<p>5.1节的Serial.exe只能运行一个实例。</p>
<p><img src="/categories/Notes/Pediy01/1688962133346.png" alt="1688962133346"></p>
<p><img src="/categories/Notes/Pediy01/1688963259744.png" alt="1688963259744"></p>
<p>修改FindWindow后面的判断逻辑即可。一开始改为了75(jnz)</p>
<p>此时可以运行多个，但是运行前需要找到已存在的一个窗口才能继续创建，再次修改程序，把jz改成jmp。</p>
<h2 id="微信"><a href="#微信" class="headerlink" title="微信"></a>微信</h2><p>先根据break定位关闭微信的函数<code>CloseWechat</code>，进而找到关键函数sub_405FD0，它控制着返回结果。</p>
<p><img src="/categories/Notes/Pediy01/1688970540191.png" alt="1688970540191"></p>
<p>关键函数<code>int __stdcall sub_405FD0(DWORD a1, int a2, int a3, int a4)</code></p>
<p>跟进去后，可以看到一开始检查注册表语言配置和更新配置。</p>
<p><img src="/categories/Notes/Pediy01/1688968867614.png" alt="1688968867614"></p>
<p>微信整体打开，靠WechatWin.dl里的函数。</p>
<p><img src="/categories/Notes/Pediy01/1688969199372.png" alt="1688969199372"></p>
<p>打开WechatWin.dll，发现其导入表里存在实例判断函数。</p>
<p><img src="/categories/Notes/Pediy01/1688969733507.png" alt="1688969733507"></p>
<p><img src="/categories/Notes/Pediy01/1688969749959.png" alt="1688969749959"></p>
<p>双击进入后，等待库加载完成，需要几分钟，之后x查看两个函数的上下文：</p>
<p>注意这里一定要多等一会，不然调用<code>CreateMutex</code>的地址可能检索不全。</p>
<p><img src="/categories/Notes/Pediy01/1688970084672.png" alt="1688970084672"></p>
<p>调用<code>FindWindowW</code>函数的上下文十分明显：</p>
<p><img src="/categories/Notes/Pediy01/1688971265497.png" alt="1688971265497"></p>
<p>对于上图尾行的这个大跳，是一个经典的判断Mutex是否存在的代码段。</p>
<blockquote>
<p>Mutex存在，则GetLastError返回 <code>ERROR_ALREADY_EXISTS</code>.，不存在时，返回0.</p>
</blockquote>
<p><img src="/categories/Notes/Pediy01/1688971805972.png" alt="1688971805972"></p>
<p>把jnz StartNewInstance改变成为jmp。</p>
<p>爆破成功。</p>
<p><img src="/categories/Notes/Pediy01/1688972258464.png" alt="1688972258464"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blueinyou.com/categories/CTF/QQ%E6%8F%90%E5%8F%96%E6%BC%8F%E6%B4%9E/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://blueinyou.com/photos/avatar.jpg">
      <meta itemprop="name" content="Paul C">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Paul C's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/categories/CTF/QQ%E6%8F%90%E5%8F%96%E6%BC%8F%E6%B4%9E/" class="post-title-link" itemprop="url">QQ Elevation复现</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2023-07-03 14:19:49 / Modified: 14:52:20" itemprop="dateCreated datePublished" datetime="2023-07-03T14:19:49+08:00">2023-07-03</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>利用QQProtect.exe提权，获得NT Authority\SYSTEM权限。</p>
</blockquote>
<h2 id="漏洞成因："><a href="#漏洞成因：" class="headerlink" title="漏洞成因："></a>漏洞成因：</h2><p>QQProtect.exe没有使用ASLR保护，篡改函数指针，利用ROP链（Ret Oriented Programming，即修改函数返回指针)实现了任意代码执行。</p>
<p>1.QQProtect.exe+0x40c9f8处，有<code>任意地址写漏洞</code>。</p>
<p>待添加自己的截图，网络截图可见：</p>
<p><img src="/categories/CTF/QQ%E6%8F%90%E5%8F%96%E6%BC%8F%E6%B4%9E/image0.png" alt="image0"></p>
<p>可以在任意地址写入DWORD(1)。</p>
<p>2.QQProtectEngine.dll+0x3B4F6处，</p>
<p>待添加自己的截图，网络截图可见：</p>
<p><img src="/categories/CTF/QQ%E6%8F%90%E5%8F%96%E6%BC%8F%E6%B4%9E/image1.png" alt="image1"></p>
<p>可以完成对任意地址的指针ptr，偏移2个ptr指针类型大小的位置处，赋值为(unsigned int )(ptr+3)。</p>
<p>Affected Products:</p>
<ul>
<li>QQ 9.7.1.28940 ~ 9.7.8.29039</li>
<li>TIM 3.4.5.22071 ~ 3.4.7.22084</li>
</ul>
<p>Affected Components:</p>
<ul>
<li>QQProtect.exe 4.5.0.9424 (in TIM 3.4.5.22071)</li>
<li>QQProtect.exe 4.5.0.9426 (in QQ 9.7.1.28940)</li>
<li>QQProtectEngine.dll 4.5.0.9424 (in TIM 3.4.5.22071)</li>
<li>QQProtectEngine.dll 4.5.0.9426 (in QQ 9.7.1.28940)</li>
</ul>
<h2 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h2><p>POC整体用rust构建，先来解析配置文件里的内容。</p>
<h3 id="1-配置文件解析"><a href="#1-配置文件解析" class="headerlink" title="1.配置文件解析"></a>1.配置文件解析</h3><p>针对32位系统使用静态链接的C运行时，构建可执行文件。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cargo +stable-i686-pc-windows-msvc build --release --config <span class="string">&quot;build.rustflags = [\&quot;-C\&quot;, \&quot;target-feature=+crt-static\&quot;]&quot;</span></span><br></pre></td></tr></table></figure>
<p>对应的toml文件</p>
<figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[profile.release]</span></span><br><span class="line"><span class="attr">opt-level</span> = <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="section">[profile.release.overrides.&#x27;cfg(target_os = &quot;windows&quot;)&#x27;]</span></span><br><span class="line"><span class="attr">rustflags</span> = [<span class="string">&quot;-C&quot;</span>, <span class="string">&quot;target-feature=+crt-static&quot;</span>]</span><br></pre></td></tr></table></figure>
<p>此时，只需要<code>cargo build --release</code>即可。</p>
<p>开发过程中，要利用一些依赖库，来调用Windows API、服务和命令行参数。</p>
<figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[dependencies.rhexdump]</span></span><br><span class="line"><span class="attr">version</span> = <span class="string">&quot;0.1.1&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="section">[dependencies.windows]</span></span><br><span class="line"><span class="attr">version</span> = <span class="string">&quot;0.44.0&quot;</span></span><br><span class="line"><span class="attr">features</span> = [</span><br><span class="line">    <span class="string">&quot;Win32_Foundation&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Win32_System_LibraryLoader&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Win32_System_Threading&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Win32_System_SystemServices&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Win32_System_Console&quot;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="section">[dependencies.windows-service]</span></span><br><span class="line"><span class="attr">version</span> = <span class="string">&quot;0.5.0&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="section">[dependencies.windows-args]</span></span><br><span class="line"><span class="attr">version</span> = <span class="string">&quot;0.2.0&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#生成动态链接库，即dll文件</span></span><br><span class="line"><span class="section">[lib]</span></span><br><span class="line"><span class="attr">crate-type</span> = [<span class="string">&quot;cdylib&quot;</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>2.定义的<code>src\lib.def</code>文件中的导出符号。</p>
<h3 id="C-名称修饰规则"><a href="#C-名称修饰规则" class="headerlink" title="C++名称修饰规则"></a>C++名称修饰规则</h3><p> C++ 的名称修饰规则，也称为名称重整（name mangling）。用于编译器生成符号表，会因平台和编译器有所不同。它将函数和变量的名称、参数类型、返回类型等信息编码成一个唯一的符号。 </p>
<p>名称修饰的目的是确保在<strong>链接阶段可以正确地解析函数和变量的符号，避免符号冲突和重复定义的问题。</strong>  为了实现不同编程语言之间的互操作性，可以使用 <code>extern &quot;C&quot;</code> 来指定使用 C 风格的符号。</p>
<blockquote>
<p>导出符号的格式是 <code>?SymbolName@ClassName@@FunctionSignature=_alias@0</code> </p>
</blockquote>
<p>下面的文件规定了导出的类和符号命，并 将所有导出符号重命名为 <code>_die</code>。 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">LIBRARY</span><br><span class="line">EXPORTS</span><br><span class="line">    ?NextSiblingElement@TiXmlNode@@QAEPAVTiXmlElement@@PBD@Z=_die@0</span><br><span class="line">    ?FirstChildElement@TiXmlNode@@QAEPAVTiXmlElement@@PBD@Z=_die@0</span><br><span class="line">    ??1TiXmlDocument@@UAE@XZ=_die@0</span><br><span class="line">    ?RootElement@TiXmlDocument@@QAEPAVTiXmlElement@@XZ=_die@0</span><br><span class="line">    ?GetText@TiXmlElement@@QBEPBDXZ=_die@0</span><br><span class="line">    ?Attribute@TiXmlElement@@QBEPBDPBD@Z=_die@0</span><br><span class="line">    ?Attribute@TiXmlElement@@QBEPBDPBDPAH@Z=_die@0</span><br><span class="line">    ?LoadXML@TiXmlDocument@@QAE_NPADHW4TiXmlEncoding@@@Z=_die@0</span><br><span class="line">    ??0TiXmlDocument@@QAE@XZ=_die@0</span><br><span class="line">    DllMain</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p> <code>QAE</code> 指示该构造函数是一个非静态成员函数，</p>
<ul>
<li><code>QB</code> 表示该函数是一个非静态成员函数，并且返回一个指针。</li>
<li><code>EPBD</code> 表示函数的第一个参数是一个 <code>const char*</code> 类型的指针。</li>
<li><code>PAH</code> 表示函数的第二个参数是一个 <code>int*</code> 类型的指针。</li>
<li><code>PAVTiXmlElement 表示返回类型是一个指向</code>TiXmlElement` 类的指针。 </li>
<li><code>0TiXmlDocument@@QAE@XZ</code>中0表示该类的默认构造函数</li>
<li><code>@Z</code>：函数参数的结尾标记 ，<code>XZ</code> 表示该构造函数不接受任何参数。 </li>
</ul>
<h3 id="代码解析"><a href="#代码解析" class="headerlink" title="代码解析"></a>代码解析</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">CreateProcessAsUserW</span>(token2, <span class="literal">None</span>, <span class="title function_ invoke__">PWSTR</span>(<span class="string">&quot;cmd.exe&quot;</span>.<span class="title function_ invoke__">encode_utf16</span>().<span class="title function_ invoke__">chain</span>(<span class="title function_ invoke__">Some</span>(<span class="number">0</span>)).collect::&lt;<span class="type">Vec</span>&lt;<span class="type">u16</span>&gt;&gt;().<span class="title function_ invoke__">as_mut_ptr</span>()), <span class="literal">None</span>, <span class="literal">None</span>, FALSE, <span class="title function_ invoke__">PROCESS_CREATION_FLAGS</span>(<span class="number">0</span>), <span class="literal">None</span>, <span class="literal">None</span>, &amp;si, &amp;<span class="keyword">mut</span> pi).<span class="title function_ invoke__">ok</span>().<span class="title function_ invoke__">unwrap</span>();</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blueinyou.com/categories/ML/AI%E4%B8%8E%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%A3%8E%E9%99%A9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://blueinyou.com/photos/avatar.jpg">
      <meta itemprop="name" content="Paul C">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Paul C's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/categories/ML/AI%E4%B8%8E%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%A3%8E%E9%99%A9/" class="post-title-link" itemprop="url">AI与大数据风险近5年论文摘要汇</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2023-06-29 14:17:22 / Modified: 11:27:40" itemprop="dateCreated datePublished" datetime="2023-06-29T14:17:22+08:00">2023-06-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ML/" itemprop="url" rel="index"><span itemprop="name">机器学习</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>大数据在医疗、金融、安全、管理等方面都有很多应用，可以用来化解这些领域中出现的风险；而大数据的应用本身又带来一系列安全隐患，需要靠机器学习技术去解决或缓解。</p>
<p>Prompt:本篇论文采用了{}机器学习技术，对大数据的{}{}特征进行建模，处理{分类}任务，达成了{}效果，在{}领域有所应用。</p>
<h3 id="大数据应用"><a href="#大数据应用" class="headerlink" title="大数据应用"></a>大数据应用</h3><p>大数据的一些应用,推荐系统、辅助决策、异常检测、关联分析</p>
<ol>
<li>数据驱动的决策：大数据分析可以提供大量的实时和历史数据，帮助组织做出更准确的决策。通过对海量数据进行挖掘和分析，可以发现隐藏的关联和趋势，从而指导业务决策和战略规划。</li>
<li>个性化服务和推荐系统：基于大数据分析的个性化服务和推荐系统可以根据用户的历史行为和偏好，提供定制化的产品和服务。这使得用户能够更好地满足其需求，提升用户体验。</li>
<li>预测和趋势分析：通过对大数据进行分析，可以预测未来趋势和行业发展方向。这对于市场营销、销售预测、风险管理等领域具有重要意义，可以帮助组织做出战略决策和规划。</li>
<li>预测和趋势分析：数据挖掘可以通过分析历史数据，发现潜在的趋势和模式，从而进行未来的预测。这在市场预测、销售预测、天气预测等领域具有重要应用。</li>
<li>客户细分和市场分析：通过对客户行为和偏好的分析，可以将客户划分为不同的细分群体，了解他们的需求和行为模式，并制定针对性的市场策略和营销活动。</li>
<li>金融欺诈检测：数据挖掘可以帮助金融机构检测异常交易和欺诈行为。通过分析大量的金融交易数据，可以识别潜在的欺诈模式和指标，及时采取相应的措施。</li>
<li>社交网络分析：数据挖掘可以揭示社交网络中的关系和影响力。通过分析社交媒体数据、用户之间的互动和信息传播，可以了解社交网络中的关键人物、群体动态和舆论趋势。</li>
<li>生物信息学：数据挖掘在生物信息学中发挥重要作用，例如基因表达数据的分析、蛋白质结构预测、基因组序列分析等，有助于理解生物学的复杂性和进行基因研究。</li>
<li>物流和供应链优化：通过对物流和供应链数据的挖掘和分析，可以优化物流路径、减少库存成本、提高配送效率，并优化供应链的整体运作。</li>
<li>医疗诊断和治疗：数据挖掘可以帮助医疗领域进行疾病诊断、药物选择和治疗计划的优化。通过分析医疗数据和患者病历，可以发现潜在的疾病模式和个体化的治疗方案。</li>
</ol>
<h2 id="大数据在风险管理领域的应用"><a href="#大数据在风险管理领域的应用" class="headerlink" title="大数据在风险管理领域的应用"></a>大数据在风险管理领域的应用</h2><h3 id="可靠性方面"><a href="#可靠性方面" class="headerlink" title="可靠性方面"></a>可靠性方面</h3><p> 基于新能源汽车大数据平台 ，研究电动汽车的锂离子电池可靠性问题， 电池故障诊断与健康状态预估 </p>
<p>[1]李放,闵永军,张涌.基于大数据的动力锂电池可靠性关键技术研究综述[J].储能科学与技术,2023,12(06):1981-1994.DOI:10.19799/j.cnki.2095-4239.2023.0316.</p>
<h3 id="医疗"><a href="#医疗" class="headerlink" title="医疗"></a>医疗</h3><p>在医疗领域，大数据的应用可以带来以下益处：</p>
<ol>
<li>疾病预测和诊断：通过分析大规模的医疗数据，可以发现潜在的疾病风险因素和诊断模式，提前进行疾病预测和诊断，从而提高治疗效果和患者生存率。</li>
<li>药物研发和治疗方案优化：大数据分析可以加速药物研发过程，帮助科学家识别潜在的药物靶点和候选化合物。此外，通过分析大量的患者数据，可以优化治疗方案，提供更个性化和有效的治疗。</li>
</ol>
<h3 id="金融"><a href="#金融" class="headerlink" title="金融"></a>金融</h3><ol>
<li>风险管理和欺诈检测：通过分析大数据，可以识别金融交易中的异常模式和风险指标，帮助金融机构及时发现潜在的欺诈行为，并采取相应措施进行风险管理。</li>
<li>个人信用评估和贷款决策：利用大数据分析个人的消费行为、信用记录和其他相关数据，可以更准确地评估个人的信用状况，并基于此做出贷款决策和利率定价。</li>
</ol>
<h2 id><a href="#" class="headerlink" title=" "></a> </h2><h3 id="计算机"><a href="#计算机" class="headerlink" title="计算机"></a>计算机</h3><p>隐私保护</p>
<p>[1]方滨兴,贾焰,李爱平等.大数据隐私保护技术综述[J].大数据,2016,2(01):1-18.</p>
<h3 id="环境、资源等其他方面"><a href="#环境、资源等其他方面" class="headerlink" title="环境、资源等其他方面"></a>环境、资源等其他方面</h3><h2 id="大数据带来的风险"><a href="#大数据带来的风险" class="headerlink" title="大数据带来的风险"></a>大数据带来的风险</h2><p> 大数据由于需要从网络等多个渠道收集数据，别有用心的攻击者可以进行数据投毒，污染模型，从而导致模型有后门生成。因此，大数据可能带来数据投毒风险。 </p>
<ol>
<li>数据隐私和安全：大数据涉及大量的个人敏感信息和机密数据，如个人身份信息、医疗记录、财务数据等。如果这些数据未经适当保护，可能会导致隐私泄露和滥用，甚至成为黑客攻击的目标。</li>
<li>偏见和歧视：大数据分析依赖于大量的历史数据，而这些数据可能反映了现实社会的偏见和歧视。如果不加以适当的处理，分析结果可能具有偏见性，导致不公平的结果和决策。</li>
<li>数据质量问题：大数据分析对数据的质量和准确性要求很高。如果数据存在错误、缺失或不完整，分析结果可能不准确或误导性，影响决策的可靠性。</li>
<li>安全漏洞和数据泄露：大数据系统中可能存在安全漏洞和弱点，攻击者可以利用这些漏洞来获取敏感数据或操纵分析结果。此外，数据共享和合作过程中的数据传输也可能面临被窃取或泄露的风险。</li>
</ol>
<h2 id="AI对大数据风险的解决"><a href="#AI对大数据风险的解决" class="headerlink" title="AI对大数据风险的解决"></a>AI对大数据风险的解决</h2><p>社交图谱、差分隐私、安全计算。</p>
<h2 id="金融-1"><a href="#金融-1" class="headerlink" title="金融"></a>金融</h2><h2 id="-1"><a href="#-1" class="headerlink" title=" "></a> </h2><h2 id="计算机-1"><a href="#计算机-1" class="headerlink" title="计算机"></a>计算机</h2><p>隐私保护</p>
<h2 id="环境、资源等其他方面-1"><a href="#环境、资源等其他方面-1" class="headerlink" title="环境、资源等其他方面"></a>环境、资源等其他方面</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blueinyou.com/categories/CTF/CTF%E9%87%8C%E7%9A%84%E5%B8%B8%E7%94%A8%E5%8A%A0%E8%A7%A3%E5%AF%86%E7%AE%97%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://blueinyou.com/photos/avatar.jpg">
      <meta itemprop="name" content="Paul C">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Paul C's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/categories/CTF/CTF%E9%87%8C%E7%9A%84%E5%B8%B8%E7%94%A8%E5%8A%A0%E8%A7%A3%E5%AF%86%E7%AE%97%E6%B3%95/" class="post-title-link" itemprop="url">CTF里的常用加密算法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2023-06-27 14:19:49" itemprop="dateCreated datePublished" datetime="2023-06-27T14:19:49+08:00">2023-06-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-06-20 16:53:38" itemprop="dateModified" datetime="2023-06-20T16:53:38+08:00">2023-06-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h2><h3 id="对RSA的攻击："><a href="#对RSA的攻击：" class="headerlink" title="对RSA的攻击："></a>对RSA的攻击：</h3><h2 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h2><h2 id="DES"><a href="#DES" class="headerlink" title="DES"></a>DES</h2><h2 id="RC4"><a href="#RC4" class="headerlink" title="RC4"></a>RC4</h2><p> 流密码 ， 一次一个字节地加密消息 ，速度快。</p>
<p><img src="/categories/CTF/CTF%E9%87%8C%E7%9A%84%E5%B8%B8%E7%94%A8%E5%8A%A0%E8%A7%A3%E5%AF%86%E7%AE%97%E6%B3%95/1687250986520.png" alt="1687250986520"></p>
<h3 id="对RC4的攻击："><a href="#对RC4的攻击：" class="headerlink" title="对RC4的攻击："></a>对RC4的攻击：</h3><h2 id="ECC"><a href="#ECC" class="headerlink" title="ECC"></a>ECC</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blueinyou.com/categories/CTF/%E6%9C%80%E6%96%B0%E6%B7%B7%E6%B7%86%E6%8A%80%E6%9C%AF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://blueinyou.com/photos/avatar.jpg">
      <meta itemprop="name" content="Paul C">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Paul C's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/categories/CTF/%E6%9C%80%E6%96%B0%E6%B7%B7%E6%B7%86%E6%8A%80%E6%9C%AF/" class="post-title-link" itemprop="url">TEB-PEB-SEH</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2023-06-20 14:19:49" itemprop="dateCreated datePublished" datetime="2023-06-20T14:19:49+08:00">2023-06-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-08-28 15:28:50" itemprop="dateModified" datetime="2023-08-28T15:28:50+08:00">2023-08-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="多态字符串混淆、"><a href="#多态字符串混淆、" class="headerlink" title="多态字符串混淆、"></a>多态字符串混淆、</h2><h2 id="基于哈希的导入解析"><a href="#基于哈希的导入解析" class="headerlink" title="基于哈希的导入解析"></a>基于哈希的导入解析</h2><h2 id="运行时常量计算"><a href="#运行时常量计算" class="headerlink" title="运行时常量计算"></a>运行时常量计算</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><a class="page-number" href="/page/8/">8</a><a class="page-number" href="/page/9/">9</a><a class="page-number" href="/page/10/">10</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Paul C"
      src="https://blueinyou.com/photos/avatar.jpg">
  <p class="site-author-name" itemprop="name">Paul C</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">172</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">62</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/memoryofsnow" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;memoryofsnow" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:2215489940@qq.com" title="E-Mail → mailto:2215489940@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://blog.csdn.net/jiyi_guoshu" title="CSDN → https:&#x2F;&#x2F;blog.csdn.net&#x2F;jiyi_guoshu" rel="noopener" target="_blank"><i class="fab fa-csdn fa-fw"></i>CSDN</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Paul C</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
          load: ['[tex]/mhchem'],
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
          packages: {'[+]': ['mhchem']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
